\subsubsection{双回文串}
\noindent
如果$s=x_1x_2=y_1y_2=z_1z_2, |x_1|<|y_1|<|z_1|, x_2, y_1, y_2, z_1$是回文串, 则$x_1$和$z_2$也是回文串. 

\subsubsection{Border 和周期}
\noindent
如果$r$是$S$的一个border, 则$|S|-r$是$S$的一个周期.\\
如果$p$和$q$都是$S$的周期, 且满足$p+q\le |S|+gcd(p,q)$, 则$gcd(p,q)$也是一个周期.

\subsubsection{字符串匹配与Border}
\noinent
若字符串$S$, $T$满足$2|S|\ge |T|$, 则$S$在$T$中所有匹配位置成一个等差数列.\\
进一步地, 若$S$的匹配次数大于2, 则等差数列的周期恰好等于$S$的最小周期.

\subsubsection{Border 的结构}
\noindent
字符串$S$的所有不小于$|S|/2$的border长度组成一个等差数列.\\
字符串$S$的所有 border 按长度排序后可分成$O(\log{|S|})$段, 每段是一个等差数列. 

\subsubsection{回文串Border}
\noindent
回文串长度为$t$的后缀是一个回文后缀, 等价于$t$是该串的border. 因此回文后缀的长度也可以划分成$O(\log{|S|})$段.

\subsubsection{子串最小后缀}
\noindent
设$s[p..n]$是$s[i..n]$, $(l \leq i \leq r)$中最小者, 则minsuf(l, r)等于$s[p..r]$的最短非空 border. minsuf(l, r) = min\{$s[p..r]$, minsuf(r − $2^k$ + 1, r)\}, $(2^k < r − l + 1 \leq 2^{k+1})$. 

\subsubsection{子串最大后缀}
\noindent
从左往右扫, 用set维护后缀的字典序递减的单调队列, 并在对应时刻添加"小于事件"点以便在之后修改队列; 查询直接在set里lower\_bound. 